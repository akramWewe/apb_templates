FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IG5hbWVzcGFjZV90ZW1wbGF0ZQpkZXNjcmlwdGlvbjogVGhpcyBp\
cyBhIHNhbXBsZSBhcHBsaWNhdGlvbiBnZW5lcmF0ZWQgYnkgYXBiIGluaXQKYmluZGFibGU6IEZh\
bHNlCmFzeW5jOiBvcHRpb25hbAptZXRhZGF0YToKICBkaXNwbGF5TmFtZTogbmFtZXNwYWNlX3Rl\
bXBsYXRlCnBsYW5zOgogIC0gbmFtZTogZGVmYXVsdAogICAgZGVzY3JpcHRpb246IFRoaXMgZGVm\
YXVsdCBwbGFuIGRlcGxveXMgbmFtZXNwYWNlX3RlbXBsYXRlCiAgICBmcmVlOiBUcnVlCiAgICBt\
ZXRhZGF0YToge30KICAgIHBhcmFtZXRlcnM6IAogICAgICAtIG5hbWU6IHJlcXVlc3RzLmNwdQog\
ICAgICAgIHRpdGxlOiBMYSBzb21tZSB0b3RhbGUgZGVzIGNwdXMgZGVtYW5kw6llIG5lIGRvaXQg\
cGFzIGTDqXBhc3NlciBjZXR0ZSB2YWxldXIKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgLSBu\
YW1lOiByZXF1ZXN0cy5tZW1vcnkKICAgICAgICB0aXRsZTogUGFyY291cmlyIHRvdXMgbGVzIFBv\
ZHMsIGxhIHNvbW1lIHRvdGFsZSBkZSBsYSBtw6ltb2lyZSBkZW1hbmTDqWUgbmUgZG9pdCBwYXMg\
ZMOpcGFzc2VyIGNldHRlIHZhbGV1cgogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAtIG5hbWU6\
IGxpbWl0cy5jcHUKICAgICAgICB0aXRsZTogUGFyY291cmlyIHRvdXMgbGVzIFBvZHMsIGxhIHNv\
bW1tZSBkZXMgbGltaXRlcyBjcHUgZGVtYW5kw6llIG5lIGRvaXQgcGFzIGTDqXBhc3NlciBjZXR0\
ZSB2YWxldXIKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgLSBuYW1lOiBsaW1pdHMubWVtb3J5\
CiAgICAgICAgdGl0bGU6IFBhcmNvdXJpciB0b3VzIGxlcyBQb2RzLCBsYSBzb21tbWUgZGVzIGxp\
bWl0ZXMgbcOpbW9pcmUgZGVtYW5kw6llIG5lIGRvaXQgcGFzIGTDqXBhc3NlciBjZXR0ZSB2YWxl\
dXIKICAgICAgICB0eXBlOiBzdHJpbmc="

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
